<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ENERGIS PDU - Help</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: sans-serif;
    }

    body {
      background-color: #1a1d23;
      color: #e4e4e4;
    }

    a {
      text-decoration: none;
      color: #aaa;
    }

    a:hover {
      color: #fff;
    }

    .topbar {
      width: 100%;
      height: 50px;
      background-color: #242731;
      display: flex;
      align-items: center;
      padding: 0 20px;
    }

    .topbar h1 {
      font-size: 1.2rem;
      color: #fff;
    }

    .container {
      display: flex;
      width: 100%;
      height: calc(100vh - 50px);
    }

    .sidebar {
      width: 220px;
      background-color: #2e323c;
      padding: 20px 0;
    }

    .sidebar ul {
      list-style: none;
    }

    .sidebar ul li {
      padding: 10px 20px;
    }

    .sidebar ul li:hover {
      background-color: #3b404d;
    }

    .main-content {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }

    h2 {
      margin-bottom: 0.5rem;
    }

    p {
      margin: 0.5rem 0;
    }

    ul {
      margin-left: 20px;
    }

    /* Secondary content sidebar layout inside main content */
    .content-layout {
      display: flex;
      gap: 20px;
      align-items: flex-start;
      margin-top: 0.5rem;
    }

    .content-sidebar {
      width: 300px;
      background-color: #2e323c;
      padding: 16px 16px 18px 16px;
      /* Increased interior padding for airiness */
      border-radius: 4px;
      font-size: 0.85rem;
      position: sticky;
      top: 10px;
      max-height: calc(100vh - 90px);
      overflow-y: auto;
    }

    .content-sidebar h3 {
      margin-top: 0;
      margin-bottom: 0.6rem;
      /* more space below heading */
      font-size: 1.1rem;
      /* slightly larger */
    }

    .content-sidebar h4 {
      margin: 0.9rem 0 0.45rem 0;
      /* larger separation between groups */
      font-size: 0.9rem;
      /* compact label but airy surroundings */
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #eeebeb;
      border-top: 1px solid #3a3f49;
      /* subtle divider */
      padding-top: 0.65rem;
    }

    .content-sidebar ul {
      list-style: none;
      margin: 0 0 0.95rem 0;
      /* more spacing after each list block */
      padding: 0;
    }

    .content-sidebar li {
      margin: 0.22rem 0 0.30rem;
      /* taller vertical rhythm */
      line-height: 1.25rem;
      /* extra breathing room per item */
    }

    .content-sidebar a {
      color: #ddd;
      font-size: 0.86rem;
      /* slightly larger for readability */
      padding: 3px 6px;
      /* clickable padding */
      border-radius: 4px;
      display: inline-block;
      /* allow padding background */
      transition: background-color 120ms ease, color 120ms ease;
    }

    .content-sidebar a:hover {
      color: #fff;
      background-color: #3b404d;
      /* subtle hover chip */
    }

    .content-body {
      flex: 1;
      min-width: 0;
      max-width: 800px;
      /* limit line length for readability; not centered per user preference */
      margin: 0;
      /* align naturally with sidebar */
      padding-right: 8px;
      /* slight inner right padding to balance */
    }

    .section {
      margin-bottom: 1.75rem;
      /* more space between sections */
      padding-bottom: 0.6rem;
      border-bottom: 1px solid #333842;
    }

    .section h3 {
      margin-top: 0.4rem;
      margin-bottom: 0.2rem;
      font-size: 1.5rem;
    }

    .section h4 {
      margin-top: 0.6rem;
      margin-bottom: 0.2rem;
      font-size: 1.1rem;
      line-height: 3;
    }

    /* Increase vertical rhythm in body text */
    .section p {
      margin: 0.75rem 0;
      /* more breathing room between paragraphs */
      line-height: 1.5;
      /* slightly taller line height */
    }

    .section ul,
    .section ol {
      margin: 0.6rem 0 1.0rem 1.1rem;
      /* add bottom space after lists */
      padding-left: 0.6rem;
      /* indent list content slightly */
    }

    .section ul li,
    .section ol li {
      margin: 0.35rem 0;
      /* space between list rows */
      line-height: 1.4;
      /* improve readability for list items */
    }

    /* Justified body text for a more symmetric edge alignment */
    .content-body p,
    .section p {
      text-align: justify;
      text-justify: inter-word;
    }

    /* Optional: justify list item text without affecting bullet alignment */
    .section ul li {
      text-align: justify;
      text-justify: inter-word;
    }

    /* Prefix QUICK LINKS (overview shortcuts) anchors with a chevron */
    .quick-links a::before {
      content: '> ';
      color: #6366f1;
      font-weight: 600;
    }

    /* Inline quick link inside paragraph/list text */
    .inline-quick a {
      color: #6366f1;
      font-style: italic;
      font-size: 1rem;
    }

    .inline-quick a::before {
      /* Four non-breaking spaces before the chevron */
      content: '\00a0\00a0\00a0\00a0> ';
      font-weight: 600;
      color: #6366f1;
    }

    /* .tagline removed */

    .muted {
      color: #a0a0a0;
      font-size: 0.82rem;
    }

    .callout {
      border-left: 3px solid #4f46e5;
      background-color: #383d55;
      padding: 8px 10px;
      margin: 0.5rem 0;
      font-size: 0.9rem;
      text-align: justify;
      text-justify: inter-word;
      line-height: 1.25;
      /* more airy */
      font-style: italic;
      /* italic text */
    }

    .callout strong {
      color: #e5e7eb;
    }

    .warning {
      border-left-color: #f97373;
      background-color: #3b1f26;
    }

    pre {
      background-color: #1e2130;
      /* or #242a33 */
      border: 1px solid #2f3642;
      padding: 8px 12px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 0.85rem;
      line-height: 1.35;
      margin: 0.55rem 0 0.9rem;
      white-space: pre;
    }

    code {
      font-family: Consolas, "Fira Code", monospace;
      font-weight: 400;
      color: #e5e7eb;
    }

    .quick-links {
      margin: 0.4rem 0 0.8rem 0;
      font-size: 1rem;
      font-style: italic;
    }

    .quick-links a {
      margin-right: 10px;
      color: #6366f1;
    }

    .quick-links a:hover {
      color: #fff;
    }

    @media (max-width: 900px) {
      .container {
        flex-direction: column;
        height: auto;
      }

      .sidebar {
        width: 100%;
      }

      .content-layout {
        flex-direction: column;
      }

      .content-sidebar {
        position: static;
        width: 100%;
        max-height: none;
      }
    }
  </style>
</head>

<body>
  <div class="topbar">
    <h1>ENERGIS 8 Channel Managed PDU</h1>
  </div>
  <div class="container">
    <div class="sidebar">
      <ul>
        <li><a href="control.html">Control</a></li>
        <li><a href="settings.html">Settings</a></li>
        <li><a href="help.html">Help</a></li>
        <li><a href="user_manual.html">User Manual</a></li>
        <li><a href="automation_manual.html">Programming Manual</a></li>
      </ul>
    </div>
    <div class="main-content">
      <div class="content-layout">
        <div class="content-sidebar">
          <h3>On this page</h3>
          <h4>User guide</h4>
          <ul>
            <li><a href="#overview">1. Overview &amp; safety</a></li>
            <li><a href="#front-panel">2. Front panel &amp; buttons</a></li>
            <li><a href="#installation">3. Installation &amp; wiring</a></li>
            <li><a href="#web-ui">4. Web interface</a></li>
            <li><a href="#sleep-mode">5. Power button &amp; sleep mode</a></li>
            <li><a href="#troubleshooting">6. Basic troubleshooting</a></li>
            <li><a href="#firmware">7. Firmware update &amp; specs</a></li>
          </ul>

          <h4>Automation &amp; integration</h4>
          <ul>
            <li><a href="#serial-cli">8. USB serial console</a></li>
            <li><a href="#http-api">9. HTTP API</a></li>
            <li><a href="#html-pages">10. Built in HTML pages</a></li>
            <li><a href="#metrics">11. /metrics (OpenMetrics)</a></li>
            <li><a href="#snmp">12. SNMP</a></li>
            <li><a href="#integration">13. Integration examples</a></li>
            <li><a href="#more-docs">14. More documentation</a></li>
          </ul>
        </div>

        <div class="content-body">
          <div class="section" id="overview">
            <h3>1. Overview &amp; safety</h3>


            <div class="callout warning">
              <strong>Warning:</strong> ENERGIS switches and distributes mains voltage. Incorrect installation or use
              can cause electric shock, fire, or damage to connected equipment. Only qualified personnel familiar with
              mains installation and local regulations should install and service the device.
            </div>

            <h4>1.1 What ENERGIS is</h4>
            <p>ENERGIS is an 8 channel managed power distribution unit for 10inch racks, lab benches and small
              installations. Each rear IECC13 outlet can be switched individually and has per channel measurements
              for voltage, current, power and uptime.</p>
            <p>You can operate the PDU:</p>
            <ul>
              <li>Locally from the front panel buttons and LEDs <span class="inline-quick"><a href="#front-panel">Front
                    panel</a></span></li>
              <li>Via the built in web interface <span class="inline-quick"><a href="#html-pages">HTML pages</a></span>
              </li>
              <li>Over USB serial CLI <span class="inline-quick"><a href="#serial-cli">Serial console</a></span></li>
              <li>Through automation interfaces:
                <ul class="automation-list">
                  <li>HTTP API <span class="inline-quick"><a href="#http-api">HTTP API</a></span></li>
                  <li>SNMP <span class="inline-quick"><a href="#snmp">SNMP</a></span></li>
                  <li>Prometheus compatible <code>/metrics</code> endpoint <span class="inline-quick"><a
                        href="#metrics">/metrics</a></span></li>
                </ul>
              </li>

            </ul>

            <h4>1.2 Intended use</h4>
            <ul>
              <li>Indoor IT, lab and test equipment compatible with local mains voltage and IECC13 outlets.</li>
              <li>Small racks and cabinets where individual outlet control and basic power monitoring are needed.</li>
            </ul>
            <p>ENERGIS is not an extension cord, surge protector, or safety / life support device.</p>

            <h4>1.3 Electrical ratings (summary)</h4>
            <ul>
              <li>Input voltage: 85VAC to 305VAC, 50/60Hz.</li>
              <li>Maximum input current: 15A at the inlet.</li>
              <li>Maximum per channel current: 15A per outlet, limited by connectors and wiring.</li>
              <li>Total current of all active outlets must not exceed 15A.</li>
            </ul>
            <p>Do not daisy chain multiple PDUs from a single mains outlet and do not feed other multi way strips from
              ENERGIS.</p>

            <h4>1.4 Grounding and environment</h4>
            <ul>
              <li>Connect the AC inlet only to a properly grounded mains outlet.</li>
              <li>Protective earth is mandatory. Do not defeat or bypass earth connection.</li>
              <li>Indoor use only, in dry, non corrosive environments without conductive dust.</li>
              <li>Typical operating temperature: 0°C to 50°C. At higher temperatures, reduce load for
                reliability.</li>
            </ul>
          </div>

          <div class="section" id="front-panel">
            <h3>2. Front panel &amp; button behavior</h3>


            <h4>2.1 Channel indicators</h4>
            <p>Each channel (CH1-CH8) has a pair of LEDs:</p>
            <ul>
              <li><strong>Green LED:</strong> outlet state
                <ul>
                  <li>On: outlet is switched on and supplies mains voltage to the rear C13 connector.</li>
                  <li>Off: outlet is switched off.</li>
                </ul>
              </li>
              <li><strong>Orange LED:</strong> selection indication
                <ul>
                  <li>Off: no selection window is active.</li>
                  <li>Blinking: this channel is currently selected in the 10s selection window.</li>
                </ul>
              </li>
            </ul>
            <p>Orange LEDs are only used while the selection window is open. Outside that time only the green on/off
              state is shown.</p>

            <h4>2.2 Status LEDs</h4>
            <ul>
              <li><strong>PWR:</strong> internal power supply is within its expected range. If this LED is off, the
                device is not operating.</li>
              <li><strong>LAN:</strong> Ethernet link detected. Indicates physical link, not full IP configuration.</li>
              <li><strong>ERR:</strong> internal error has been detected. Clear it with a long press of the Set button.
                If it returns, see <a href="#troubleshooting">Basic troubleshooting</a>.</li>
            </ul>

            <h4>2.3 Selection window logic</h4>
            <p>The three front panel buttons use a time limited selection window to avoid accidental switching.</p>
            <ul>
              <li><strong>Opening the window:</strong>
                <ul>
                  <li>A short press on any of the three buttons (Left, Right, Set) when idle opens a 10s selection
                    window.</li>
                  <li>One channel is selected and its orange LED starts blinking.</li>
                  <li>No outlet state changes with this first press; it only opens the window.</li>
                </ul>
              </li>
              <li><strong>While the window is open:</strong>
                <ul>
                  <li><strong>Left / Right:</strong> move the selection to previous / next channel. The blinking orange
                    LED follows and wraps between CH1 and CH8.</li>
                  <li><strong>Set (short press):</strong> toggles the selected outlet on/off. The green LED updates.
                  </li>
                  <li><strong>Set (long press, approx. 1s):</strong> clears ERR. Does not change any outlet state.
                  </li>
                  <li>Any valid button press restarts the 10s timeout.</li>
                </ul>
              </li>
              <li><strong>Closing the window:</strong>
                <ul>
                  <li>If there is no button activity for 10s, the selection window closes and all orange LEDs turn
                    off.</li>
                </ul>
              </li>
            </ul>
          </div>

          <div class="section" id="sleep-mode">
            <h3>3. Power button &amp; sleep mode</h3>


            <p>The front panel power button controls a low power sleep state for the whole unit.</p>
            <ul>
              <li><strong>Device active, long press (&gt; 2s):</strong> enters low power sleep.
                <ul>
                  <li>All outputs are turned off.</li>
                  <li>PWR LED blinks at 0.5Hz (1s on, 1s off).</li>
                  <li>All normal functionality becomes unavailable until wakeup.</li>
                </ul>
              </li>
              <li><strong>Device active, short press:</strong> no effect.</li>
              <li><strong>Device in sleep, short press:</strong> wakes the device and returns to active mode. Normal
                operation resumes.</li>
              <li><strong>Device in sleep, long press:</strong> no additional effect.</li>
            </ul>
          </div>

          <div class="section" id="installation">
            <h3>4. Installation &amp; wiring</h3>


            <div class="callout warning">
              <strong>Important:</strong> All work on the mains supply must be done by qualified personnel. Always
              verify ratings and grounding before energizing the device.
            </div>

            <h4>4.1 Mounting in a rack</h4>
            <ul>
              <li>Designed for 10inch racks and small cabinets, 1U height.</li>
              <li>Use the mounting ears with suitable screws or cage nuts.</li>
              <li>Avoid mechanical stress on front panel and connectors during installation.</li>
              <li>Leave clearance for rear cables and some airflow. Keep LEDs and buttons visible.</li>
            </ul>

            <h4>4.2 Power connection</h4>
            <ol>
              <li>Verify local mains voltage matches the rating on the device label.</li>
              <li>Connect the AC inlet to a properly grounded mains outlet using a suitable cable rated at 15A.
              </li>
              <li>Check upstream protection (fuse or breaker) and wiring are appropriate for 15A maximum input
                current.</li>
              <li>Once powered, verify that PWR LED is lit.</li>
            </ol>

            <h4>4.3 Connecting loads</h4>
            <ul>
              <li>Use IECC14 cord sets or certified adapters for the rear C13 outlets.</li>
              <li>Document which device is plugged into which channel (CH1-CH8).</li>
              <li>Best practice: switch the outlet off before plugging or unplugging loads to minimise arcing and
                unintended reboots.</li>
              <li>Keep total current within the 15A limit and distribute high power loads across channels.</li>
              <li>Do not daisy chain other PDUs or multi strips from ENERGIS outlets.</li>
            </ul>

            <h4>4.4 Network connection</h4>
            <ol>
              <li>Connect the RJ45 port to a switch/router using a standard Ethernet cable (CAT5 or better).</li>
              <li>Confirm that the LAN LED is lit, indicating a physical link.</li>
              <li>Use the IP address from the product label or from your documentation.</li>
              <li>From a host in the same subnet, open <code>http://&lt;device-ip&gt;/</code> in a browser to reach the
                web UI.</li>
            </ol>

            <h4>4.5 USB connection (console)</h4>
            <ul>
              <li>Connect the front USBC port to a computer.</li>
              <li>The OS will detect a USB CDC (virtual COM) device; usually no extra driver is required.</li>
              <li>Use 115200baud, 8data bits, no parity, 1stop bit.</li>
              <li>Use the console for commissioning, diagnostics and advanced configuration. Normal daily use can be
                done via web UI and front panel.</li>
            </ul>
          </div>

          <div class="section" id="web-ui">
            <h3>5. Web interface</h3>


            <h4>5.1 Accessing the web UI</h4>
            <ol>
              <li>Ensure PWR and LAN LEDs indicate that the unit is powered and linked.</li>
              <li>Make sure your computer is in the same IP subnet or routing is configured appropriately.</li>
              <li>Open <code>http://&lt;device-ip&gt;/</code> or <code>http://&lt;device-ip&gt;/control.html</code> in a
                modern browser.</li>
            </ol>

            <h4>5.2 Control page (<a href="control.html">control.html</a>)</h4>
            <ul>
              <li>Shows one row per outlet (CH1-CH8).</li>
              <li>Per channel:
                <ul>
                  <li>Outlet state (ON/OFF) and control to toggle the relay.</li>
                  <li>Measured voltage, current, power and channel uptime.</li>
                </ul>
              </li>
              <li>Values update periodically from internal telemetry. Measurements are cached; they do not change
                instantly at the moment of switching.</li>
            </ul>

            <h4>5.3 Settings page (<a href="settings.html">settings.html</a>)</h4>
            <ul>
              <li><strong>Device identification:</strong> name, location, temperature unit.</li>
              <li><strong>Network configuration:</strong> IP address, subnet mask, gateway, DNS server.</li>
            </ul>
            <p>After changing IP parameters, the device stores them and reboots. You then reach it under the new IP.</p>
            <div class="callout warning">
              <strong>Caution:</strong> After changing IP/subnet/gateway, the PDU becomes unreachable at the old
              address. Make sure you know the new configuration and how to access the device again.
            </div>
          </div>

          <div class="section" id="troubleshooting">
            <h3>6. Basic troubleshooting</h3>


            <h4>6.1 Web UI not reachable</h4>
            <ol>
              <li><strong>Check LEDs:</strong> PWR must be on; LAN must be on or blinking.</li>
              <li><strong>Check cabling:</strong> Ethernet cable properly connected; switch port enabled.</li>
              <li><strong>Check IP:</strong> confirm you are using the correct IP and that your host is in the same
                network.</li>
              <li><strong>Ping test:</strong> run <code>ping &lt;device-ip&gt;</code> from a PC. If it fails, double
                check network settings.</li>
              <li><strong>Errors:</strong> if ERR is lit, long press Set to clear. Power cycle the device if needed.
              </li>
            </ol>

            <h4>6.2 Outlets do not switch</h4>
            <ul>
              <li>Confirm you are addressing the correct channel for the physical outlet.</li>
              <li>Check ERR LED and clear it with a long press on Set.</li>
              <li>Verify upstream protection (breaker/fuse) has not tripped.</li>
              <li>Ensure total load does not exceed 15A.</li>
            </ul>

            <h4>6.3 Measurements show zero</h4>
            <ul>
              <li>Check the outlet’s green LED is on and a real load is connected.</li>
              <li>Wait a few seconds; telemetry is updated periodically.</li>
              <li>Very light loads may show very low or zero current and power.</li>
            </ul>

            <h4>6.4 Forgot the IP address</h4>
            <ul>
              <li>Check the label on the underside for factory default network settings.</li>
              <li>Check installation notes where the configured IP might be recorded.</li>
              <li>If needed, network settings can be reset via the console, restoring defaults (see <a
                  href="#serial-cli">USB serial console</a>).</li>
            </ul>
          </div>

          <div class="section" id="firmware">
            <h3>7. Firmware update &amp; technical summary</h3>


            <h4>7.1 Firmware update via UF2</h4>
            <ol>
              <li>Obtain the correct <code>.uf2</code> file for your hardware revision.</li>
              <li>Connect ENERGIS via USBC to a computer. Mains can stay connected during the update.</li>
              <li>Open a serial terminal (see <a href="#serial-cli">USB serial console</a>) and run the
                <code>BOOTSEL</code> command, or use the documented button sequence to enter boot mode.
              </li>
              <li>The device appears as a USB mass storage drive.</li>
              <li>Copy the <code>.uf2</code> file onto the drive and wait until it finishes and the drive disappears.
              </li>
              <li>ENERGIS restarts with the new firmware. Verify operation via the web UI or the console command
                <code>SYSINFO</code>.
              </li>
            </ol>

            <div class="callout warning">
              <strong>Caution:</strong> Do not disconnect power or USB while copying the <code>.uf2</code> file.
              Interrupting the update can corrupt the image and require recovery.
            </div>

            <h4>7.2 Technical data (short)</h4>
            <ul>
              <li>Input: 85VAC to 305VAC, 50/60Hz, 15A max.</li>
              <li>Outputs: 8x IECC13, each up to 15A, max 15A total.</li>
              <li>Form factor: 10inch rack, 1U.</li>
              <li>Interfaces: RJ4510/100 Ethernet, USBC (USB CDC console).</li>
              <li>Per channel metering: HLW8032 based, used internally by firmware.</li>
            </ul>
          </div>

          <div class="section" id="serial-cli">
            <h3>8. USB serial console</h3>


            <h4>8.1 Access</h4>
            <ul>
              <li>Connect USBC to a host.</li>
              <li>Open a serial terminal at 115200baud, 8N1.</li>
              <li>Type <code>HELP</code> to see supported commands.</li>
            </ul>

            <h4>8.2 Typical commands</h4>
            <ul>
              <li><code>HELP</code> - list commands.</li>
              <li><code>SYSINFO</code> - show firmware version and basic system info.</li>
              <li><code>GET_TEMP</code> - MCU temperature.</li>
              <li><code>REBOOT</code> - restart the device.</li>
              <li><code>BOOTSEL</code> - enter USB mass storage mode for firmware update.</li>
              <li><code>CLR_ERR</code> - clear internal error (same as long press Set).</li>
              <li><code>RFS</code> - restore factory settings (network and preferences).</li>
            </ul>

            <h4>8.3 Outlet control</h4>
            <ul>
              <li><code>SET_CH &lt;ch&gt; &lt;STATE&gt;</code> - set channel <code>ch</code> (1-8) to ON/OFF or ALL:
                <ul>
                  <li>State can be <code>0</code>/<code>OFF</code> or <code>1</code>/<code>ON</code>, or
                    <code>ALL</code> where supported.
                  </li>
                </ul>
              </li>
              <li><code>GET_CH &lt;ch&gt;</code> - read state of a channel or all channels.</li>
              <li><code>READ_HLW8032</code> - read meter snapshot for all channels.</li>
            </ul>

            <h4>8.4 Network configuration</h4>
            <ul>
              <li><code>NETINFO</code> - prints current IP, subnet, gateway, DNS.</li>
              <li><code>SET_IP &lt;ip&gt;</code>, <code>SET_SN &lt;mask&gt;</code>, <code>SET_GW &lt;gw&gt;</code>,
                <code>SET_DNS &lt;dns&gt;</code> - set network parameters.
              </li>
              <li><code>CONFIG_NETWORK ip$sn$gw$dns</code> - configure all network parameters in one command.</li>
            </ul>
          </div>

          <div class="section" id="http-api">
            <h3>9. HTTP API</h3>


            <p>The embedded HTTP server listens on port80 and exposes JSON endpoints under <code>/api/...</code>.
              All responses use HTTP/1.1 and include <code>Connection: close</code>.</p>

            <h4>9.1 GET /api/status</h4>
            <p>Returns overall status and per channel telemetry.</p>
            <ul>
              <li><code>channels</code> - array of 8 objects, each containing <code>voltage</code>,
                <code>current</code>, <code>uptime</code>, <code>power</code>, <code>state</code>.
              </li>
              <li><code>internalTemperature</code> - MCU die temperature.</li>
              <li><code>temperatureUnit</code> - such as <code>"°C"</code>.</li>
              <li><code>systemStatus</code> - short status string.</li>
            </ul>
            <pre><code>curl http://&lt;device-ip&gt;/api/status</code></pre>

            <h4>9.2 POST /api/control</h4>
            <p>Control relays using simple form encoded data. Each field is named <code>channelN</code> for
              N=1..8.</p>
            <ul>
              <li><code>channelN=on</code> - turn channel N on.</li>
              <li>Omit the field or set it to an empty string to turn the channel off.</li>
            </ul>
            <pre><code># Turn channels 1 and 3 on, all others off
curl -X POST "http://&lt;device-ip&gt;/api/control" \
 --data "channel1=on&amp;channel3=on"</code></pre>

            <h4>9.3 GET /api/settings</h4>
            <p>Returns current network configuration and user preferences in JSON.</p>
            <ul>
              <li>Typical fields: <code>ip</code>, <code>subnet</code>, <code>gateway</code>, <code>dns</code>,
                <code>device_name</code>, <code>location</code>, <code>temp_unit</code>, <code>temperature</code>.
              </li>
            </ul>
            <pre><code>curl http://&lt;device-ip&gt;/api/settings</code></pre>

            <h4>9.4 POST /api/settings</h4>
            <p>Updates network parameters and user preferences. Uses form encoded data.</p>
            <pre><code>curl -X POST "http://&lt;device-ip&gt;/api/settings" \
 --data "ip=192.168.0.12&amp;subnet=255.255.255.0&amp;gateway=192.168.0.1&amp;dns=8.8.8.8&amp;device_name=ENERGIS&amp;location=Rack1&amp;temp_unit=celsius"</code></pre>
            <p>On success, the device stores the configuration, replies with 204NoContent and then reboots.
            </p>
          </div>

          <div class="section" id="html-pages">
            <h3>10. Built in HTML pages</h3>


            <ul>
              <li><strong>control.html</strong> - main outlet control and monitoring.</li>
              <li><strong>settings.html</strong> - network and basic configuration.</li>
              <li><strong>help.html</strong> - this offline help page.</li>
              <li><strong>user_manual.html</strong> - landing page for the full User Manual.</li>
              <li><strong>automation_manual.html</strong> - landing page for automation/programming documentation.</li>
            </ul>
          </div>

          <div class="section" id="metrics">
            <h3>11. /metrics (OpenMetrics / Prometheus)</h3>


            <h4>11.1 Endpoint</h4>
            <p>The <code>/metrics</code> endpoint exposes metrics in Prometheus/OpenMetrics text format.</p>
            <pre><code>curl http://&lt;device-ip&gt;/metrics</code></pre>

            <h4>11.2 Global metrics (examples)</h4>
            <ul>
              <li><code>energis_up</code> - gauge, 1 if the metrics handler is healthy.</li>
              <li><code>energis_build_info{version,serial}</code> - gauge always 1, with labels identifying the build.
              </li>
              <li><code>energis_uptime_seconds_total</code> - counter, total uptime in seconds.</li>
              <li><code>energis_internal_temperature_celsius</code> - gauge, MCU temperature.</li>
              <li><code>energis_vusb_volts</code>, <code>energis_vsupply_volts</code> - gauges, internal rails.</li>
            </ul>

            <h4>11.3 Per channel metrics (examples)</h4>
            <p>Each channel has label <code>{ch="1"}</code> to <code>{ch="8"}</code>.</p>
            <ul>
              <li><code>energis_channel_state{ch}</code> - gauge, 1 for on, 0 for off.</li>
              <li><code>energis_channel_telemetry_valid{ch}</code> - gauge, 1 if cached telemetry is fresh.</li>
              <li><code>energis_channel_voltage_volts{ch}</code> - gauge.</li>
              <li><code>energis_channel_current_amps{ch}</code> - gauge.</li>
              <li><code>energis_channel_power_watts{ch}</code> - gauge.</li>
              <li><code>energis_channel_energy_watt_hours_total{ch}</code> - counter, accumulated energy.</li>
            </ul>
            <p>Metrics are produced from cached meter data and never perform blocking I/O in the handler. If the output
              would exceed the internal buffer, the handler returns HTTP503 to signal an error instead of emitting
              partial metrics.</p>

            <h4>11.4 Prometheus configuration example</h4>
            <pre><code>scrape_configs:
 - job_name: 'energis-pdu'
   metrics_path: /metrics
   scrape_interval: 15s
   static_configs:
     - targets: ['192.168.0.22:80']
       labels:
         location: 'rack-1'
         device: 'pdu-main'</code></pre>
          </div>

          <div class="section" id="snmp">
            <h3>12. SNMP</h3>


            <h4>12.1 Overview</h4>
            <ul>
              <li>SNMP version: v1.</li>
              <li>Community: <code>public</code>.</li>
              <li>MIB-II system group implemented.</li>
              <li>Private enterprise subtree: <code>1.3.6.1.4.1.19865</code>.</li>
            </ul>

            <h4>12.2 System OIDs (MIB-II)</h4>
            <ul>
              <li><code>1.3.6.1.2.1.1.1.0</code> - <code>sysDescr</code>, descriptive text.</li>
              <li><code>1.3.6.1.2.1.1.2.0</code> - <code>sysObjectID</code>, set to the enterprise ID.</li>
              <li><code>1.3.6.1.2.1.1.3.0</code> - <code>sysUpTime</code>.</li>
              <li><code>1.3.6.1.2.1.1.4.0</code> - <code>sysContact</code>.</li>
              <li><code>1.3.6.1.2.1.1.5.0</code> - <code>sysName</code>, often serial number.</li>
              <li><code>1.3.6.1.2.1.1.6.0</code> - <code>sysLocation</code>.</li>
              <li><code>1.3.6.1.2.1.1.7.0</code> - <code>sysServices</code>.</li>
            </ul>

            <h4>12.3 Outlet control OIDs</h4>
            <p>Per channel outlet state is exposed as INTEGER under the enterprise subtree:</p>
            <ul>
              <li><code>1.3.6.1.4.1.19865.2.&lt;ch&gt;.0</code> with <code>&lt;ch&gt; = 1..8</code>.</li>
            </ul>
            <p>Behavior:</p>
            <ul>
              <li>GET returns 0 for off, 1 for on.</li>
              <li>SET 0 turns the channel off.</li>
              <li>SET non zero turns the channel on.</li>
            </ul>

            <h4>12.4 Group control OIDs</h4>
            <ul>
              <li><code>1.3.6.1.4.1.19865.2.9.0</code> - All OFF:
                <ul>
                  <li>GET: 1 only if all channels are off.</li>
                  <li>SET: any non zero value forces all channels off.</li>
                </ul>
              </li>
              <li><code>1.3.6.1.4.1.19865.2.10.0</code> - All ON:
                <ul>
                  <li>GET: 1 only if all channels are on.</li>
                  <li>SET: any non zero value forces all channels on.</li>
                </ul>
              </li>
            </ul>

            <h4>12.5 Telemetry via SNMP</h4>
            <p>Per channel telemetry is encoded as short strings under <code>1.3.6.1.4.1.19865.5</code>:</p>
            <ul>
              <li>Voltage (V): <code>1.3.6.1.4.1.19865.5.&lt;ch&gt;.1.0</code>, e.g. <code>"230.12"</code>.</li>
              <li>Current (A): <code>1.3.6.1.4.1.19865.5.&lt;ch&gt;.2.0</code>, e.g. <code>"0.534"</code>.</li>
              <li>Power (W): <code>1.3.6.1.4.1.19865.5.&lt;ch&gt;.3.0</code>, e.g. <code>"85.3"</code>.</li>
              <li>Power factor: <code>1.3.6.1.4.1.19865.5.&lt;ch&gt;.4.0</code>, e.g. <code>"0.998"</code>.</li>
              <li>Energy (kWh): <code>1.3.6.1.4.1.19865.5.&lt;ch&gt;.5.0</code>.</li>
              <li>Channel uptime (s): <code>1.3.6.1.4.1.19865.5.&lt;ch&gt;.6.0</code>.</li>
            </ul>
            <p>All values are served from cached internal meter data and do not trigger blocking operations in the SNMP
              handler.</p>
          </div>

          <div class="section" id="integration">
            <h3>13. Integration examples</h3>


            <h4>13.1 Simple shell control with curl</h4>
            <pre><code># Turn channel 2 on from a shell script
curl -s -o /dev/null -X POST "http://&lt;device-ip&gt;/api/control" \
 --data "channel2=on"</code></pre>

            <h4>13.2 Periodic status logging</h4>
            <pre><code># Log JSON status every minute (example cron entry)
* * * * * curl -s "http://&lt;device-ip&gt;/api/status" &gt;&gt; /var/log/energis_status.json</code></pre>

            <h4>13.3 Prometheus /metrics scraping</h4>
            <pre><code>scrape_configs:
 - job_name: 'energis-pdu'
   metrics_path: /metrics
   scrape_interval: 15s
   static_configs:
     - targets: ['192.168.0.22:80']
       labels:
         location: 'rack-1'</code></pre>

            <h4>13.4 SNMP in a network monitoring tool</h4>
            <ul>
              <li>Add ENERGIS as an SNMPv1 device with community <code>public</code>.</li>
              <li>Graph the outlet state OIDs under <code>1.3.6.1.4.1.19865.2</code> (0/1) and telemetry values under
                <code>1.3.6.1.4.1.19865.5</code>.
              </li>
              <li>Use All ON / All OFF OIDs to build basic control buttons.</li>
            </ul>
          </div>

          <div class="section" id="more-docs">
            <h3>14. More documentation</h3>


            <p>This help page is an embedded summary. For full detail, use:</p>
            <ul>
              <li><a href="user_manual.html">User Manual</a> - complete installation, safety and technical data.</li>
              <li><a href="automation_manual.html">Programming &amp; Automation Manual</a> - protocol details, OID
                tables, and extended examples.</li>
            </ul>
            <p>Project sources, issue tracking and firmware releases are available through the official repository
              referenced in the printed documentation and product label.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

</html>