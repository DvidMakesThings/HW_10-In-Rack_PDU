<map id="write_port_from_shadow" name="write_port_from_shadow">
<area shape="rect" id="Node000001" title=" " alt="" coords="1251,301,1415,328"/>
<area shape="rect" id="Node000002" href="$group__driver7.html#ga5d50f36be11f0195d0f36b793b69e4fb" title="Initializes the relay board&#39;s MCP23017." alt="" coords="1098,301,1203,328"/>
<area shape="poly" id="edge1_Node000001_Node000002" title=" " alt="" coords="1236,317,1204,317,1204,312,1236,312"/>
<area shape="rect" id="Node000050" href="$group__driver7.html#ga17f51c0f9c1cdb9ed3825af73da10621" title="Atomically set/clear a group of bits on a given port from a mask." alt="" coords="880,479,1036,505"/>
<area shape="poly" id="edge69_Node000001_Node000050" title=" " alt="" coords="1299,339,1190,402,1122,437,1051,469,1017,481,1016,476,1049,464,1119,433,1188,397,1296,334"/>
<area shape="rect" id="Node000052" href="$group__driver7.html#ga553fcd3d3d73cb09bc17d6b28b6e914c" title="Writes a digital value to a specific MCP23017 pin. Uses shadowed whole&#45;port writes under a mutex to a..." alt="" coords="888,175,1028,201"/>
<area shape="poly" id="edge70_Node000001_Node000052" title=" " alt="" coords="1280,298,1174,259,1049,216,1011,205,1012,199,1051,211,1176,254,1282,293"/>
<area shape="rect" id="Node000003" href="$group__main03.html#gafe3a0b770057ac7103be4185e393395f" title="Initializes Core 0." alt="" coords="456,23,534,49"/>
<area shape="poly" id="edge2_Node000002_Node000003" title=" " alt="" coords="1135,289,1101,227,1077,194,1048,165,986,122,917,89,844,66,770,50,699,41,634,36,534,36,534,31,634,31,700,36,771,45,845,61,919,84,989,117,1052,161,1081,191,1106,224,1140,286"/>
<area shape="rect" id="Node000005" href="$group__driver7.html#ga9b5f742b94d4fe906f755ee724283ed0" title="Reads the digital value from a specific MCP23017 pin." alt="" coords="659,327,796,353"/>
<area shape="poly" id="edge4_Node000002_Node000005" title=" " alt="" coords="1082,314,980,312,866,317,791,329,790,323,865,312,980,307,1082,309"/>
<area shape="rect" id="Node000045" href="$group__driver7.html#ga4ff3d9494f9b6420a1826db6d18d6b1a" title="Reads a value from a specified MCP23017 register (guarded)." alt="" coords="889,327,1027,353"/>
<area shape="poly" id="edge50_Node000002_Node000045" title=" " alt="" coords="1083,326,1028,334,1027,328,1082,321"/>
<area shape="rect" id="Node000046" href="$group__driver7.html#ga41f24ca3aebfd711c56f11bbb090f640" title="Re&#45;sync software shadows from hardware OLAT (optional utility)." alt="" coords="866,377,1050,404"/>
<area shape="poly" id="edge51_Node000002_Node000046" title=" " alt="" coords="1114,338,1051,368,1017,379,1015,374,1049,363,1111,333"/>
<area shape="rect" id="Node000048" href="$group__driver7.html#gab1ef2508fd1f0c02cb7ec65efe0cf682" title="Sets the direction of a specific MCP23017 pin." alt="" coords="877,428,1039,455"/>
<area shape="poly" id="edge53_Node000002_Node000048" title=" " alt="" coords="1133,342,1098,381,1051,418,1026,430,1024,425,1049,414,1094,377,1129,338"/>
<area shape="poly" id="edge55_Node000002_Node000050" title=" " alt="" coords="1135,343,1052,469,1031,480,1028,476,1048,465,1131,340"/>
<area shape="poly" id="edge57_Node000002_Node000052" title=" " alt="" coords="1129,291,1094,252,1049,216,1024,204,1026,199,1051,211,1098,248,1133,288"/>
<area shape="rect" id="Node000059" href="$group__driver7.html#gaf73b2d26f4d7ccd1f537fe726ba1f462" title="Writes a value to a specified MCP23017 register (guarded)." alt="" coords="887,225,1028,252"/>
<area shape="poly" id="edge67_Node000002_Node000059" title=" " alt="" coords="1105,297,1049,273,1000,255,1002,250,1051,268,1107,292"/>
<area shape="rect" id="Node000004" href="$group__main01.html#gae3fa85d0ce445e937670de85f9af490a" title="Global variable to trigger BOOTSEL mode." alt="" coords="27,23,123,49"/>
<area shape="poly" id="edge3_Node000003_Node000004" title=" " alt="" coords="441,27,353,13,273,8,193,13,124,26,123,21,192,8,273,3,353,8,442,22"/>
<area shape="rect" id="Node000006" href="$group__driver1.html#ga81a3ea6eb9a8a16aa49da9543e4f3bd4" title="Execute SET short&#45;press action: toggle the selected relay." alt="" coords="211,124,335,151"/>
<area shape="poly" id="edge5_Node000005_Node000006" title=" " alt="" coords="644,326,495,291,434,274,400,260,388,248,381,235,374,211,368,187,351,165,334,154,336,149,355,161,373,185,379,210,385,233,392,244,402,255,435,269,497,286,645,320"/>
<area shape="rect" id="Node000009" href="$group__snmp2.html#ga0771afab8e4d202bbc5540825f2afc3b" title="Read all 8 relay states and return as a bitmask." alt="" coords="450,647,540,673"/>
<area shape="poly" id="edge7_Node000005_Node000009" title=" " alt="" coords="648,360,639,367,619,397,610,426,609,455,612,484,616,514,617,545,610,578,591,611,568,633,540,649,538,644,565,629,587,608,605,576,611,545,611,515,607,485,604,455,605,425,614,394,635,364,644,356"/>
<area shape="rect" id="Node000012" href="$group__snmp2.html#ga8fce002de43387ac46d4fce1257762dc" title="Read relay state for channel ch (0..7) into SNMP buffer." alt="" coords="408,951,582,977"/>
<area shape="poly" id="edge10_Node000005_Node000012" title=" " alt="" coords="648,359,639,367,622,399,612,444,606,498,603,557,602,673,599,723,592,762,572,819,548,873,507,952,502,949,544,871,567,817,587,761,593,722,596,673,598,557,601,498,606,443,617,397,635,364,644,356"/>
<area shape="rect" id="Node000021" href="$group__webui5.html#gabec26dab8e118ff845c2fde12dc885cf" title="Handles the HTTP request for the status page." alt="" coords="419,723,571,749"/>
<area shape="poly" id="edge19_Node000005_Node000021" title=" " alt="" coords="647,360,639,367,614,406,604,445,605,483,611,521,618,561,621,601,614,643,591,687,569,709,541,725,539,720,565,705,587,684,609,641,616,601,613,561,606,522,599,483,599,444,609,404,635,364,644,356"/>
<area shape="rect" id="Node000024" href="$group__uart.html#ga5ece76769b8fd390a2b6133fa234a706" title="Handle UART GET_CH command." alt="" coords="428,555,562,597"/>
<area shape="poly" id="edge21_Node000005_Node000024" title=" " alt="" coords="647,361,639,367,626,381,619,395,612,422,607,453,592,487,560,525,526,556,523,552,556,522,587,484,602,451,607,421,614,393,622,378,636,363,644,357"/>
<area shape="rect" id="Node000027" href="$group__driver3.html#ga0b3a5c410541deaf144c3e33d4b65175" title="Poll a single channel for power measurements." alt="" coords="207,73,338,100"/>
<area shape="poly" id="edge23_Node000005_Node000027" title=" " alt="" coords="690,321,642,294,588,268,535,252,490,247,446,237,424,226,399,209,381,185,374,160,368,137,351,114,334,103,336,98,355,110,373,134,380,159,386,182,403,205,426,222,448,232,490,242,536,247,590,263,645,289,692,316"/>
<area shape="rect" id="Node000028" href="$group__driver3.html#ga76f09e4482db113563628126492d3200" title="Refresh power measurements for all channels." alt="" coords="205,23,341,49"/>
<area shape="poly" id="edge25_Node000005_Node000028" title=" " alt="" coords="696,319,635,266,613,241,588,220,561,207,537,201,492,197,447,192,424,182,399,165,387,152,380,139,374,113,368,87,362,75,351,63,334,52,337,48,355,59,366,72,373,86,379,112,385,137,392,149,403,161,426,177,449,186,492,192,538,196,563,202,591,215,617,237,639,262,699,315"/>
<area shape="rect" id="Node000029" href="$group__driver6.html#ga65d23685098ebf6b4f8bca89409a90ab" title="Compute full&#45;chip asymmetry mask (1 bits where relay!=display)." alt="" coords="401,377,589,404"/>
<area shape="poly" id="edge26_Node000005_Node000029" title=" " alt="" coords="649,360,560,379,559,374,648,355"/>
<area shape="rect" id="Node000032" href="$group__driver6.html#gae49e94d74eefe80449e590bf8798fb17" title="Periodic asymmetry guardian for the two MCP23017s." alt="" coords="193,545,353,572"/>
<area shape="poly" id="edge38_Node000005_Node000032" title=" " alt="" coords="649,362,639,368,624,379,615,391,606,404,591,418,529,460,478,487,354,536,323,547,321,542,352,531,475,482,527,455,588,414,602,401,611,388,620,376,636,363,646,357"/>
<area shape="rect" id="Node000043" href="$group__driver6.html#ga889bb68e8929772801ed4cf4836a801d" title="Write both MCPs for one pin only if needed, and report asymmetry." alt="" coords="440,124,550,151"/>
<area shape="poly" id="edge39_Node000005_Node000043" title=" " alt="" coords="692,320,663,295,635,266,620,239,613,215,605,193,588,171,570,159,550,151,552,146,572,155,591,167,610,191,618,214,625,237,639,262,667,291,696,315"/>
<area shape="rect" id="Node000044" href="$group__driver6.html#gace05145c93133aa7e479bec6c0613677" title="Write both MCPs for one pin only if needed, and report asymmetry, with logging." alt="" coords="412,327,578,353"/>
<area shape="poly" id="edge40_Node000005_Node000044" title=" " alt="" coords="643,343,579,343,579,337,643,337"/>
<area shape="rect" id="Node000007" href="$group__driver1.html#ga60c16d2b5323dc486ad6208a244ed7ae" title="Unified GPIO interrupt handler for PLUS, MINUS, and SET buttons." alt="" coords="36,124,114,151"/>
<area shape="poly" id="edge6_Node000006_Node000007" title=" " alt="" coords="195,140,115,140,115,135,195,135"/>
<area shape="rect" id="Node000010" href="$group__snmp2.html#gaae5465f6b70d234aa38096a810f5fad8" title="SNMP getter for “all off” OID. Returns the same bitmask as get_allState()." alt="" coords="235,647,311,673"/>
<area shape="poly" id="edge8_Node000009_Node000010" title=" " alt="" coords="434,663,312,663,312,657,434,657"/>
<area shape="rect" id="Node000011" href="$group__snmp2.html#ga4ef4a107594909096b39054767b014f4" title="SNMP getter for “all on” OID. Returns the same bitmask as get_allState()." alt="" coords="235,697,311,724"/>
<area shape="poly" id="edge9_Node000009_Node000011" title=" " alt="" coords="435,676,312,705,311,699,434,671"/>
<area shape="rect" id="Node000013" href="$group__snmp2.html#gade7df1ea335261e38c6b1c2a61ed2ded" title="Get the state of the outlet (relay) as an integer." alt="" coords="211,799,334,825"/>
<area shape="poly" id="edge11_Node000012_Node000013" title=" " alt="" coords="470,941,419,890,386,863,352,840,327,828,329,824,354,835,390,859,422,886,474,937"/>
<area shape="rect" id="Node000014" href="$group__snmp2.html#gabbff421a9229e31a0cb05761892eec6e" title="Get the state of outlet 2 (relay) as an integer." alt="" coords="211,849,334,876"/>
<area shape="poly" id="edge12_Node000012_Node000014" title=" " alt="" coords="457,945,408,917,352,891,321,879,323,874,354,886,410,913,459,940"/>
<area shape="rect" id="Node000015" href="$group__snmp2.html#gae617a671308e5f001c463b793cfe7a03" title="Get the state of outlet 3 (relay) as an integer." alt="" coords="211,900,334,927"/>
<area shape="poly" id="edge13_Node000012_Node000015" title=" " alt="" coords="418,949,334,930,335,925,419,944"/>
<area shape="rect" id="Node000016" href="$group__snmp2.html#gac540752940c1f251d408f0954c14364d" title="Get the state of outlet 4 (relay) as an integer." alt="" coords="211,951,334,977"/>
<area shape="poly" id="edge14_Node000012_Node000016" title=" " alt="" coords="393,967,335,967,335,961,393,961"/>
<area shape="rect" id="Node000017" href="$group__snmp2.html#ga03c6e3cdf72aa5de6d3b9c1fc220add0" title="Get the state of outlet 5 (relay) as an integer." alt="" coords="211,1001,334,1028"/>
<area shape="poly" id="edge15_Node000012_Node000017" title=" " alt="" coords="419,984,335,1003,334,998,418,979"/>
<area shape="rect" id="Node000018" href="$group__snmp2.html#ga62abeab3df59bba29de074d147e280f2" title="Get the state of outlet 6 (relay) as an integer." alt="" coords="211,1052,334,1079"/>
<area shape="poly" id="edge16_Node000012_Node000018" title=" " alt="" coords="459,988,410,1016,354,1043,323,1054,321,1049,352,1038,408,1011,457,983"/>
<area shape="rect" id="Node000019" href="$group__snmp2.html#ga45aa10db7cd7f4c2a207b81312c7a95f" title="Get the state of outlet 7 (relay) as an integer." alt="" coords="211,1103,334,1129"/>
<area shape="poly" id="edge17_Node000012_Node000019" title=" " alt="" coords="474,991,422,1042,390,1069,354,1093,329,1105,327,1100,352,1088,386,1065,419,1038,470,987"/>
<area shape="rect" id="Node000020" href="$group__snmp2.html#ga219cf7f985467e92225ffcd452f81464" title="Get the state of outlet 8 (relay) as an integer." alt="" coords="211,1153,334,1180"/>
<area shape="poly" id="edge18_Node000012_Node000020" title=" " alt="" coords="482,992,432,1067,396,1108,354,1144,332,1155,330,1151,352,1139,392,1104,428,1064,477,990"/>
<area shape="rect" id="Node000022" href="$group__webui3.html#ga52702a4dcaff4540a9ddd10e4d5f4525" title="Processes incoming HTTP requests." alt="" coords="5,620,145,647"/>
<area shape="poly" id="edge20_Node000021_Node000022" title=" " alt="" coords="407,755,357,759,302,759,246,753,192,739,157,720,127,696,84,649,88,645,130,692,160,716,194,734,247,748,302,754,357,754,406,749"/>
<area shape="rect" id="Node000025" href="$group__uart.html#gaf78d8689607ba97d44d30e4e3fc56533" title="Parse and execute a received UART command string." alt="" coords="9,440,141,467"/>
<area shape="poly" id="edge22_Node000024_Node000025" title=" " alt="" coords="413,599,362,607,305,609,247,603,192,586,153,561,121,529,97,495,81,468,86,466,101,492,125,525,156,557,194,582,248,598,305,604,361,601,412,594"/>
<area shape="poly" id="edge24_Node000027_Node000004" title=" " alt="" coords="202,72,123,51,124,46,204,66"/>
<area shape="poly" id="edge27_Node000029_Node000006" title=" " alt="" coords="402,370,399,367,381,342,373,316,371,290,374,264,376,239,375,214,368,189,351,165,334,152,337,148,355,161,373,187,381,213,382,239,379,265,377,290,378,315,385,339,403,364,406,366"/>
<area shape="rect" id="Node000030" href="$group__webui1.html#ga204196bd085f7a778067392b56920c59" title="Handles the HTTP request for the control page. Uses set_relay_state_tag() for idempotent writes + log..." alt="" coords="195,393,350,420"/>
<area shape="poly" id="edge28_Node000029_Node000030" title=" " alt="" coords="386,401,351,404,351,398,385,396"/>
<area shape="rect" id="Node000031" href="$group__uart.html#gaba75c17603725c8ac0d758f31229b240" title="Handle UART SET_CH command. Uses set_relay_state_tag(&quot;UART&quot;, ...) to log who wrote." alt="" coords="206,276,340,319"/>
<area shape="poly" id="edge30_Node000029_Node000031" title=" " alt="" coords="415,374,400,368,375,351,352,333,329,322,332,317,354,328,378,346,402,363,418,369"/>
<area shape="poly" id="edge32_Node000029_Node000032" title=" " alt="" coords="451,414,426,430,403,450,388,472,381,493,373,514,355,535,336,547,333,542,351,531,368,512,376,491,383,470,399,446,423,426,448,410"/>
<area shape="rect" id="Node000033" href="$group__snmp2.html#gab580ecbc111f7cd62a6221c8c3cb2097" title="Set the state of all outlets (relays) OFF when val == 1." alt="" coords="235,343,311,369"/>
<area shape="poly" id="edge33_Node000029_Node000033" title=" " alt="" coords="391,377,311,365,312,359,391,372"/>
<area shape="rect" id="Node000034" href="$group__snmp2.html#ga02b1776dfb345252500b75e80306e42e" title="Turn all outlets on when val != 0." alt="" coords="235,444,311,471"/>
<area shape="poly" id="edge34_Node000029_Node000034" title=" " alt="" coords="434,412,312,449,311,444,433,407"/>
<area shape="rect" id="Node000035" href="$group__snmp2.html#gade035c518f601160052fdb2b9a9e07d8" title="Set the state of the outlet (relay) based on the input value." alt="" coords="211,175,334,201"/>
<area shape="poly" id="edge35_Node000029_Node000035" title=" " alt="" coords="403,371,399,367,384,348,376,329,374,290,372,252,365,234,351,215,333,203,336,199,355,211,370,231,377,251,379,290,382,327,389,346,403,364,407,367"/>
<area shape="rect" id="Node000036" href="$group__snmp2.html#gaaf4b3c8e88f82cff6c131736426720d2" title="Set the state of outlet 2 (relay) based on the input value." alt="" coords="211,495,334,521"/>
<area shape="poly" id="edge36_Node000029_Node000036" title=" " alt="" coords="459,415,403,450,379,469,354,485,327,497,325,492,352,480,376,464,399,446,456,410"/>
<area shape="rect" id="Node000037" href="$group__snmp2.html#gaba61710e5dc590d5c862562112d59338" title="Set the state of outlet 3 (relay) based on the input value." alt="" coords="211,225,334,252"/>
<area shape="poly" id="edge37_Node000029_Node000037" title=" " alt="" coords="405,372,399,367,387,355,380,342,374,316,368,290,362,278,351,266,334,255,336,250,355,262,366,275,373,288,379,314,385,340,392,352,403,363,408,367"/>
<area shape="poly" id="edge29_Node000030_Node000022" title=" " alt="" coords="200,430,194,434,172,456,151,480,119,533,96,584,83,621,78,619,91,582,114,531,147,477,168,452,191,430,197,425"/>
<area shape="poly" id="edge31_Node000031_Node000025" title=" " alt="" coords="201,329,194,333,161,360,131,390,88,441,84,438,127,386,158,356,191,329,198,324"/>
<area shape="poly" id="edge41_Node000044_Node000006" title=" " alt="" coords="413,321,399,310,385,291,378,272,375,235,372,199,365,182,351,165,334,153,337,148,355,161,369,179,377,198,380,235,383,271,390,289,403,306,417,317"/>
<area shape="poly" id="edge42_Node000044_Node000030" title=" " alt="" coords="427,361,402,368,354,384,319,395,317,390,352,379,400,363,426,355"/>
<area shape="poly" id="edge43_Node000044_Node000031" title=" " alt="" coords="407,326,340,313,341,308,408,321"/>
<area shape="poly" id="edge44_Node000044_Node000032" title=" " alt="" coords="406,364,403,367,388,387,380,407,379,449,378,492,371,514,355,535,339,547,336,543,351,532,366,511,373,491,374,449,375,406,383,385,399,364,402,361"/>
<area shape="poly" id="edge45_Node000044_Node000033" title=" " alt="" coords="397,350,312,356,311,351,396,345"/>
<area shape="poly" id="edge46_Node000044_Node000034" title=" " alt="" coords="410,363,403,367,387,383,379,400,371,417,355,434,334,446,312,453,310,448,332,441,351,430,367,414,374,397,383,380,399,363,408,358"/>
<area shape="poly" id="edge47_Node000044_Node000035" title=" " alt="" coords="417,322,399,310,381,286,375,261,368,238,351,215,334,204,336,200,355,211,373,236,380,260,386,283,403,306,420,318"/>
<area shape="poly" id="edge48_Node000044_Node000036" title=" " alt="" coords="407,364,403,367,391,381,384,395,379,424,375,454,367,470,355,485,336,497,333,493,351,481,363,467,369,453,374,423,379,393,386,378,399,363,404,360"/>
<area shape="poly" id="edge49_Node000044_Node000037" title=" " alt="" coords="426,323,400,310,385,299,375,288,366,277,352,266,327,255,329,250,354,262,369,273,379,284,388,295,402,306,428,318"/>
<area shape="rect" id="Node000047" href="$group__driver6.html#ga7f5d7a9f6239ad2bdd32a6c5bbb2396d" title="Resynchronize both MCP23017 shadow latches from hardware OLAT registers." alt="" coords="637,377,818,404"/>
<area shape="poly" id="edge52_Node000046_Node000047" title=" " alt="" coords="850,393,818,393,818,388,850,388"/>
<area shape="rect" id="Node000049" href="$group__driver6.html#ga0f044ade72bf35d0f080db7ecb4d114c" title="Configure pin direction on both MCP23017 chips." alt="" coords="648,428,807,455"/>
<area shape="poly" id="edge54_Node000048_Node000049" title=" " alt="" coords="861,444,807,444,807,439,861,439"/>
<area shape="rect" id="Node000051" href="$group__driver6.html#ga881bcc923a6be895363969bbff79dc1e" title="Atomically write a masked group of bits on both MCP23017 chips." alt="" coords="652,479,803,505"/>
<area shape="poly" id="edge56_Node000050_Node000051" title=" " alt="" coords="865,495,804,495,804,489,865,489"/>
<area shape="rect" id="Node000053" href="$group__driver3.html#gac1bd84c5a254283faacc776489f36625" title="Initialize the HLW8032 power measurement interface." alt="" coords="681,73,774,100"/>
<area shape="poly" id="edge58_Node000052_Node000053" title=" " alt="" coords="921,169,872,141,817,115,774,100,776,95,819,110,875,136,923,164"/>
<area shape="rect" id="Node000054" href="$group__driver6.html#gaea03923bde53674db77e1e4428b0e912" title="Write a digital value to a pin on both MCP23017 chips." alt="" coords="659,175,796,201"/>
<area shape="poly" id="edge60_Node000052_Node000054" title=" " alt="" coords="872,191,796,191,796,185,872,185"/>
<area shape="rect" id="Node000055" href="$group__driver3.html#ga317577d37ad844a15b55a8f5e55126f3" title="Select a channel on the multiplexer." alt="" coords="683,124,772,151"/>
<area shape="poly" id="edge63_Node000052_Node000055" title=" " alt="" coords="878,173,771,150,773,144,879,168"/>
<area shape="poly" id="edge59_Node000053_Node000003" title=" " alt="" coords="665,76,534,47,535,42,666,71"/>
<area shape="poly" id="edge61_Node000054_Node000043" title=" " alt="" coords="647,173,550,152,551,147,649,168"/>
<area shape="poly" id="edge62_Node000054_Node000044" title=" " alt="" coords="650,210,639,216,598,242,562,274,510,328,506,325,558,270,595,238,636,211,648,205"/>
<area shape="rect" id="Node000056" href="$group__driver3.html#ga204d3cdc833db3ce315ff247e3f79400" title="Read power measurements from the specified channel." alt="" coords="444,73,546,100"/>
<area shape="poly" id="edge64_Node000055_Node000056" title=" " alt="" coords="668,127,546,100,547,95,669,122"/>
<area shape="poly" id="edge65_Node000056_Node000027" title=" " alt="" coords="429,89,339,89,339,84,429,84"/>
<area shape="poly" id="edge66_Node000056_Node000028" title=" " alt="" coords="429,74,334,53,335,47,430,69"/>
<area shape="rect" id="Node000060" href="$group__driver6.html#gac00aa0678cb81d6bb6add9d0f8ab0de4" title="Write a value to a register on both MCP23017 chips." alt="" coords="659,225,796,252"/>
<area shape="poly" id="edge68_Node000059_Node000060" title=" " alt="" coords="872,241,797,241,797,236,872,236"/>
</map>
